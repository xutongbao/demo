!function(a){"use strict";function e(c,d,e){var k,l,o,f=this;return d=d||{},o=a.extend(!0,{async:!0,overwriteCache:!1,complete:null,success:null,error:function(){a(this).each(function(){a(this).html(o.errorMessage)})},errorMessage:"There was an error loading the template.",paged:!1,pageNo:1,elemPerPage:10,append:!1,prepend:!1,beforeInsert:null,afterInsert:null,bindingOptions:{ignoreUndefined:!1,ignoreNull:!1,ignoreEmptyString:!1}},e),"array"===a.type(d)?h.call(this,c,d,o):(g(c)||(k=a(c),"string"==typeof c&&0===c.indexOf("#")&&(o.isFile=!1)),l=o.isFile||"undefined"==typeof o.isFile&&("undefined"==typeof k||0===k.length),l&&!o.overwriteCache&&b[c]?j(c,f,d,o):l&&!o.overwriteCache&&b.hasOwnProperty(c)?i(c,f,d,o):l?m(c,f,d,o):n(k,f,d,o),this)}function f(b,c){c?d[b]=c:d=a.extend(d,b)}function g(a){return"string"==typeof a&&a.indexOf("/")>-1}function h(b,c,d){d=d||{};var l,f=this,g=c.length,h=d.prepend&&!d.append,i=0,j=0,k=!1;if(d.paged){var m=(d.pageNo-1)*d.elemPerPage;c=c.slice(m,m+d.elemPerPage),g=c.length}return l=a.extend({},d,{complete:function(){this.html&&(h?f.prepend(this.html()):f.append(this.html())),i++,(i===g||k)&&(k&&d&&"function"==typeof d.error&&d.error.call(f),d&&"function"==typeof d.complete&&d.complete())},success:function(){j++,j===g&&d&&"function"==typeof d.success&&d.success()},error:function(){k=!0}}),d.append||d.prepend||f.html(""),h&&c.reverse(),a(c).each(function(){var c=a("<div/>");if(e.call(c,b,this,l),k)return!1}),this}function i(a,b,d,e){c[a]?c[a].push({data:d,selection:b,settings:e}):c[a]=[{data:d,selection:b,settings:e}]}function j(a,c,d,e){var f=b[a].clone();o.call(c,f,d,e),"function"==typeof e.success&&e.success()}function k(){return(new Date).getTime()}function l(a){return a.indexOf("?")!==-1?a+"&_="+k():a+"?_="+k()}function m(c,d,e,f){var g=a("<div/>");b[c]=null;var h=c;f.overwriteCache&&(h=l(h)),a.ajax({url:h,async:f.async,success:function(a){g.html(a),q(g,c,d,e,f)},error:function(){p(c,d,e,f)}})}function n(b,c,d,e){var f=a("<div/>");(b.is("script")||b.is("template"))&&(b=a.parseHTML(a.trim(b.html()))),f.html(b),o.call(c,f,d,e),"function"==typeof e.success&&e.success()}function o(b,c,d){r(b,c,d),a(this).each(function(){var c=a(b.html());d.beforeInsert&&d.beforeInsert(c),d.append?a(this).append(c):d.prepend?a(this).prepend(c):a(this).html(c),d.afterInsert&&d.afterInsert(c)}),"function"==typeof d.complete&&d.complete.call(a(this))}function p(b,d,e,f){var g;for("function"==typeof f.error&&f.error.call(d),a(c[b]).each(function(a,b){"function"==typeof b.settings.error&&b.settings.error.call(b.selection)}),"function"==typeof f.complete&&f.complete.call(d);c[b]&&(g=c[b].shift());)"function"==typeof g.settings.complete&&g.settings.complete.call(g.selection);"undefined"!=typeof c[b]&&c[b].length>0&&(c[b]=[])}function q(a,d,e,f,g){var h;for(b[d]=a.clone(),o.call(e,a,f,g),"function"==typeof g.success&&g.success.call(e);c[d]&&(h=c[d].shift());)o.call(h.selection,b[d].clone(),h.data,h.settings),"function"==typeof h.settings.success&&h.settings.success.call(h.selection)}function r(b,c,d){c=c||{},s("data-content",b,c,d,function(a,b){a.html(y(a,b,"content",d))}),s("data-content-append",b,c,d,function(a,b){a.append(y(a,b,"content",d))}),s("data-content-prepend",b,c,d,function(a,b){a.prepend(y(a,b,"content",d))}),s("data-content-text",b,c,d,function(a,b){a.text(y(a,b,"content",d))}),s("data-content-html",b,c,d,function(a,b){a.html(y(a,b,"content",d))}),s("data-src",b,c,d,function(a,b){a.attr("src",y(a,b,"src",d))},function(a){a.remove()}),s("data-href",b,c,d,function(a,b){a.attr("href",y(a,b,"href",d))},function(a){a.remove()}),s("data-alt",b,c,d,function(a,b){a.attr("alt",y(a,b,"alt",d))}),s("data-download",b,c,d,function(a,b){a.attr("download",y(a,b,"download",d))}),s("data-for",b,c,d,function(a,b){a.attr("for",y(a,b,"for",d))}),s("data-title",b,c,d,function(a,b){a.attr("title",y(a,b,"title",d))}),s("data-id",b,c,d,function(a,b){a.attr("id",y(a,b,"id",d))}),s("data-value",b,c,d,function(a,b){a.attr("value",y(a,b,"value",d))}),s("data-link",b,c,d,function(b,c){var e=a("<a/>");e.attr("href",y(b,c,"link",d)),e.html(b.html()),b.html(e)}),s("data-link-wrap",b,c,d,function(b,c){var e=a("<a/>");e.attr("href",y(b,c,"link-wrap",d)),b.wrap(e)}),s("data-options",b,c,d,function(b,c){a(c).each(function(){var c=a("<option/>");c.attr("value",this).text(this).appendTo(b)})}),v(b,c,d)}function s(b,c,d,e,f,g){a("["+b+"]",c).each(function(){var c=a(this),h=c.attr(b),i=x(d,h);return t(c,i,e)?(c.removeAttr(b),void("undefined"!=typeof i&&f?f(c,i):g&&g(c))):void c.remove()})}function t(a,b,c){var d=u(a,c);return(!d.ignoreUndefined||"undefined"!=typeof b)&&((!d.ignoreNull||null!==b)&&(!d.ignoreEmptyString||""!==b))}function u(b,c){var d={};return b instanceof jQuery&&b.attr("data-binding-options")?(d=a.parseJSON(b.attr("data-binding-options")),b.removeAttr("data-binding-options")):"object"==typeof b&&b.hasOwnProperty("bindingOptions")&&(d=b.bindingOptions),a.extend({},c.bindingOptions,d)}function v(b,c,d){a("[data-template-bind]",b).each(function(){var b=a(this),e=a.parseJSON(b.attr("data-template-bind"));b.removeAttr("data-template-bind"),a(e).each(function(){var e;if(e="object"==typeof this.value?x(c,this.value.data):x(c,this.value),this.attribute){if(!t(this,e,d))return void b.remove();switch(this.attribute){case"content":b.html(w(b,e,this));break;case"contentAppend":b.append(w(b,e,this));break;case"contentPrepend":b.prepend(w(b,e,this));break;case"contentText":b.text(w(b,e,this));break;case"options":var f=this;a(e).each(function(){var c=a("<option/>");c.attr("value",this[f.value.value]).text(w(b,this[f.value.content],f)).attr("selected",void 0!=typeof this[f.value.selected]&&this[f.value.selected]).appendTo(b)});break;default:b.attr(this.attribute,w(b,e,this))}}})})}function w(a,b,c,e){return c.formatter&&d[c.formatter]?function(e){return d[c.formatter].call(a,b,c.formatOptions,e)}(e):b}function x(a,b){if("this"===b)return a;for(var d,c=b.split("."),e=a;(d=c.shift())&&"undefined"!=typeof e&&null!=e;)e=e[d];return e}function y(b,c,e,f){var h,g=b.attr("data-format-target");if((g===e||!g&&"content"===e)&&(h=b.attr("data-format"),h&&"function"==typeof d[h])){var i=b.attr("data-format-options");return function(e){return d[h].call(b[0],c,i,a.extend({},e))}(f)}return c}var b={},c={},d={};f("nestedTemplateFormatter",function(b,c,d){if(c){"string"==typeof c&&"{"===c[0]&&(c=a.parseJSON(c));var e=c.parentElement||"div",f=c.template||c;return c.parentElement?a("<"+e+"/>").loadTemplate(f,b,d):a("<"+e+"/>").loadTemplate(f,b,d).children()}}),a.fn.loadTemplate=e,a.addTemplateFormatter=f}(jQuery);